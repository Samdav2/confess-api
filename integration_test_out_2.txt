INFO:sqlalchemy.engine.Engine:select pg_catalog.version()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:select current_schema()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:show standard_conforming_strings
INFO:sqlalchemy.engine.Engine:[raw sql] ()
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT users.id, users.username, users.email, users.password, users.referred_by, users.referral_code, users.email_verified, users.google_auth, users.created_at, users.updated_at 
FROM users 
 LIMIT $1::INTEGER
INFO:sqlalchemy.engine.Engine:[generated in 0.00025s] (1,)
INFO:app.service.confess_form:Initializing ConfessFormService with API key starting with: AIzaS
INFO:sqlalchemy.engine.Engine:SELECT confess_forms.id, confess_forms.user_id, confess_forms.confess_type, confess_forms.tone, confess_forms.message, confess_forms.anonymous, confess_forms.card_design, confess_forms.delivery, confess_forms.email, confess_forms.phone, confess_forms.sender_name, confess_forms.recipient_name, confess_forms.paid, confess_forms.slug, confess_forms.created_at, confess_forms.updated_at 
FROM confess_forms 
WHERE confess_forms.slug = $1::VARCHAR
INFO:sqlalchemy.engine.Engine:[generated in 0.00064s] ('ys9iGgZO',)
INFO:sqlalchemy.engine.Engine:INSERT INTO confess_forms (id, user_id, confess_type, tone, message, anonymous, card_design, delivery, email, phone, sender_name, recipient_name, paid, slug, created_at, updated_at) VALUES ($1::UUID, $2::UUID, $3::confesstype, $4::VARCHAR, $5::VARCHAR, $6::BOOLEAN, $7::INTEGER, $8::deliverymethod, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::BOOLEAN, $14::VARCHAR, $15::TIMESTAMP WITH TIME ZONE, $16::TIMESTAMP WITH TIME ZONE)
INFO:sqlalchemy.engine.Engine:[generated in 0.00040s] (UUID('6a79c894-422b-433f-8b96-3febe6d13b95'), UUID('7af11c88-9b31-4e7b-a0e0-ed1b02d7e334'), 'DINNER_DATE', 'Appreciative', 'You are a great friend.', False, 0, 'EMAIL', 'test@example.com', None, None, 'Test Recipient', True, 'ys9iGgZO', datetime.datetime(2026, 1, 31, 15, 35, 44, 143417, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 1, 31, 15, 35, 44, 143447, tzinfo=datetime.timezone.utc))
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT confess_forms.id, confess_forms.user_id, confess_forms.confess_type, confess_forms.tone, confess_forms.message, confess_forms.anonymous, confess_forms.card_design, confess_forms.delivery, confess_forms.email, confess_forms.phone, confess_forms.sender_name, confess_forms.recipient_name, confess_forms.paid, confess_forms.slug, confess_forms.created_at, confess_forms.updated_at 
FROM confess_forms 
WHERE confess_forms.id = $1::UUID
INFO:sqlalchemy.engine.Engine:[generated in 0.00049s] (UUID('6a79c894-422b-433f-8b96-3febe6d13b95'),)
INFO:sqlalchemy.engine.Engine:SELECT confession_ai_messages.id AS confession_ai_messages_id, confession_ai_messages.confess_form_id AS confession_ai_messages_confess_form_id, confession_ai_messages.message AS confession_ai_messages_message, confession_ai_messages.created_at AS confession_ai_messages_created_at 
FROM confession_ai_messages 
WHERE $1::UUID = confession_ai_messages.confess_form_id
INFO:sqlalchemy.engine.Engine:[generated in 0.00052s] (UUID('6a79c894-422b-433f-8b96-3febe6d13b95'),)
INFO:google_genai.models:AFC is enabled with max remote calls: 10.
INFO:sqlalchemy.engine.Engine:INSERT INTO confession_ai_messages (id, confess_form_id, message, created_at) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::TIMESTAMP WITH TIME ZONE)
INFO:sqlalchemy.engine.Engine:[generated in 0.00030s] (UUID('2638bd36-6970-43eb-bf5e-7140721dcab3'), UUID('6a79c894-422b-433f-8b96-3febe6d13b95'), "Test Recipient, there's something I've been wanting to share, and it feels like the right moment. Thinking about our dinners, about the way the conve ... (255 characters truncated) ... e moments, over shared plates and quiet laughter, have become incredibly precious to me. Thank you for being you, and for sharing that light with me.", datetime.datetime(2026, 1, 31, 15, 35, 53, 614089, tzinfo=datetime.timezone.utc))
INFO:sqlalchemy.engine.Engine:COMMIT
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:SELECT confess_forms.id, confess_forms.user_id, confess_forms.confess_type, confess_forms.tone, confess_forms.message, confess_forms.anonymous, confess_forms.card_design, confess_forms.delivery, confess_forms.email, confess_forms.phone, confess_forms.sender_name, confess_forms.recipient_name, confess_forms.paid, confess_forms.slug, confess_forms.created_at, confess_forms.updated_at 
FROM confess_forms 
WHERE confess_forms.id = $1::UUID
INFO:sqlalchemy.engine.Engine:[cached since 9.466s ago] (UUID('6a79c894-422b-433f-8b96-3febe6d13b95'),)
INFO:sqlalchemy.engine.Engine:SELECT confession_ai_messages.id AS confession_ai_messages_id, confession_ai_messages.confess_form_id AS confession_ai_messages_confess_form_id, confession_ai_messages.message AS confession_ai_messages_message, confession_ai_messages.created_at AS confession_ai_messages_created_at 
FROM confession_ai_messages 
WHERE $1::UUID = confession_ai_messages.confess_form_id
INFO:sqlalchemy.engine.Engine:[cached since 9.17s ago] (UUID('6a79c894-422b-433f-8b96-3febe6d13b95'),)
INFO:sqlalchemy.engine.Engine:ROLLBACK
Testing with user: adoxop1@gmail.com

--- Starting create_confess_form ---

✅ SUCCESS! Response:
AI Message: Test Recipient, there's something I've been wanting to share, and it feels like the right moment. Thinking about our dinners, about the way the conversation flows so easily, about the genuine warmth I feel when I'm with you… it's made me realize something. I truly appreciate you. More than I think I've ever articulated. It's in the way you listen, really listen, and the way you make me feel seen. Those moments, over shared plates and quiet laughter, have become incredibly precious to me. Thank you for being you, and for sharing that light with me.

✨ Looks like a real AI message!
